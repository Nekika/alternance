<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CartoGIS54 - Plugin QGIS | Suivi d&#39;alternance</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
    <meta name="description" content="Ce rapport présentera l'institution et le service au sein desquels l'alternance a été réalisée.">
    <link rel="preload" href="/assets/css/0.styles.b54b7f1b.css" as="style"><link rel="preload" href="/assets/js/app.585f677d.js" as="script"><link rel="preload" href="/assets/js/2.25621a30.js" as="script"><link rel="preload" href="/assets/js/3.4803905f.js" as="script"><link rel="prefetch" href="/assets/js/10.a84ed7be.js"><link rel="prefetch" href="/assets/js/11.c3483099.js"><link rel="prefetch" href="/assets/js/12.5b8e5e0f.js"><link rel="prefetch" href="/assets/js/13.f51a0617.js"><link rel="prefetch" href="/assets/js/14.456db0f2.js"><link rel="prefetch" href="/assets/js/15.b61b254a.js"><link rel="prefetch" href="/assets/js/16.d56ee440.js"><link rel="prefetch" href="/assets/js/17.fd238609.js"><link rel="prefetch" href="/assets/js/18.1bd6d2e1.js"><link rel="prefetch" href="/assets/js/19.62f1f392.js"><link rel="prefetch" href="/assets/js/20.af1c8f38.js"><link rel="prefetch" href="/assets/js/21.e807520c.js"><link rel="prefetch" href="/assets/js/4.f4ed8133.js"><link rel="prefetch" href="/assets/js/5.1257138e.js"><link rel="prefetch" href="/assets/js/6.477c9701.js"><link rel="prefetch" href="/assets/js/7.62ae0272.js"><link rel="prefetch" href="/assets/js/8.71c0e7a1.js"><link rel="prefetch" href="/assets/js/9.5bffacd4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b54b7f1b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Suivi d'alternance</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Accueil
</a></div><div class="nav-item"><a href="/presentation.html" class="nav-link">
  Présentation
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Prérequis" class="dropdown-title"><span class="title">Prérequis</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/prerequis/" class="nav-link">
  À propos
</a></li><li class="dropdown-item"><!----> <a href="/prerequis/qgis.html" class="nav-link">
  QGIS
</a></li><li class="dropdown-item"><!----> <a href="/prerequis/qgis-server.html" class="nav-link">
  QGIS Server
</a></li><li class="dropdown-item"><!----> <a href="/prerequis/lizmap.html" class="nav-link">
  Lizmap
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Projets annexes" class="dropdown-title"><span class="title">Projets annexes</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/projets-annexes/" class="nav-link">
  À propos
</a></li><li class="dropdown-item"><!----> <a href="/projets-annexes/modal.html" class="nav-link">
  Modal
</a></li><li class="dropdown-item"><!----> <a href="/projets-annexes/smc.html" class="nav-link">
  SMC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CartoGIS54" class="dropdown-title"><span class="title">CartoGIS54</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cartogis54/" class="nav-link router-link-active">
  À propos
</a></li><li class="dropdown-item"><!----> <a href="/cartogis54/client.html" class="nav-link">
  Application client
</a></li><li class="dropdown-item"><!----> <a href="/cartogis54/plugin.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Plugin QGIS
</a></li></ul></div></div><div class="nav-item"><a href="/liens.html" class="nav-link">
  Liens
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Accueil
</a></div><div class="nav-item"><a href="/presentation.html" class="nav-link">
  Présentation
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Prérequis" class="dropdown-title"><span class="title">Prérequis</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/prerequis/" class="nav-link">
  À propos
</a></li><li class="dropdown-item"><!----> <a href="/prerequis/qgis.html" class="nav-link">
  QGIS
</a></li><li class="dropdown-item"><!----> <a href="/prerequis/qgis-server.html" class="nav-link">
  QGIS Server
</a></li><li class="dropdown-item"><!----> <a href="/prerequis/lizmap.html" class="nav-link">
  Lizmap
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Projets annexes" class="dropdown-title"><span class="title">Projets annexes</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/projets-annexes/" class="nav-link">
  À propos
</a></li><li class="dropdown-item"><!----> <a href="/projets-annexes/modal.html" class="nav-link">
  Modal
</a></li><li class="dropdown-item"><!----> <a href="/projets-annexes/smc.html" class="nav-link">
  SMC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CartoGIS54" class="dropdown-title"><span class="title">CartoGIS54</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/cartogis54/" class="nav-link router-link-active">
  À propos
</a></li><li class="dropdown-item"><!----> <a href="/cartogis54/client.html" class="nav-link">
  Application client
</a></li><li class="dropdown-item"><!----> <a href="/cartogis54/plugin.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Plugin QGIS
</a></li></ul></div></div><div class="nav-item"><a href="/liens.html" class="nav-link">
  Liens
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>CartoGIS54 - Plugin QGIS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/cartogis54/plugin.html#introduction" class="sidebar-link">Introduction</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/cartogis54/plugin.html#analyse" class="sidebar-link">Analyse</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cartogis54/plugin.html#besoins" class="sidebar-link">Besoins</a></li></ul></li><li><a href="/cartogis54/plugin.html#solution-proposee" class="sidebar-link">Solution proposée</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cartogis54/plugin.html#fonctionnement" class="sidebar-link">Fonctionnement</a></li><li class="sidebar-sub-header"><a href="/cartogis54/plugin.html#structure" class="sidebar-link">Structure</a></li><li class="sidebar-sub-header"><a href="/cartogis54/plugin.html#developpement" class="sidebar-link">Développement</a></li></ul></li><li><a href="/cartogis54/plugin.html#conclusion" class="sidebar-link">Conclusion</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="plugin-qgis"><a href="#plugin-qgis" class="header-anchor">#</a> Plugin QGIS</h1> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>En parralèle du développment de l'application client, j'ai mis au point un <strong>plugin QGIS</strong> qui en <strong>facilite la configuration</strong>.</p> <div class="custom-block tip"><p class="custom-block-title">Informations</p> <p><strong>Contexte</strong> : Pour rendre CartoGIS54 générique et adaptable à tous les projets, un fichier de configuration a été mis en place.</p> <p><strong>Problème</strong> : Remplir le fichier de configuration manuellement peut s'avérer fastidieux.</p> <p><strong>Objectif</strong> : Proposer un extension QGIS qui génèrera un fichier de configuration à partir d'informations saisies par l'utilisateur.</p> <p><strong>Technologies utilisées</strong> : Python</p></div> <h2 id="analyse"><a href="#analyse" class="header-anchor">#</a> Analyse</h2> <p>Cette extension a été pensée pour permettre aux utilisateurs de QGIS d'obtenir une certaine <strong>uniformité</strong> entre leurs <strong>projets</strong> et les <strong>applications Web</strong> qu'ils créent à l'aide de <strong>CartoGIS54</strong>.</p> <p>En effet, l'idée est de proposer un plugin capable de <strong>convertir la configuration d'un projet QGIS en un fichier de configuration interprétable CartoGIS54</strong>, tout en permettant à l'utilisateur de <strong>saisir des informations</strong> telles que <strong>l'adresse du serveur de flux WMS/WFS</strong>.</p> <p>Ayant déjà eu l'occasion de développer une extension QGIS au cours de mon apprentissage (cf. <a href="/projets-annexes/smc">Projets annexes - SMC</a>), j'ai gagné un temps précieux et j'ai pu me concentrer sur <strong>l'analyse des besoins</strong>.</p> <h3 id="besoins"><a href="#besoins" class="header-anchor">#</a> Besoins</h3> <p>Pour que l'extension soit capable de <strong>générer</strong> un fichier de configuration à partir des <strong>réglages</strong> d'un projet QGIS et d'<strong>informations</strong> saisies par l'utilisateur, il est nécessaire de mettre en places <strong>3 fonctionnalités principales</strong>.</p> <h4 id="recuperer-la-configuration-des-couches"><a href="#recuperer-la-configuration-des-couches" class="header-anchor">#</a> Récupérer la configuration des couches</h4> <p>Pour chaque couche, QGIS offre la possibilité de personnaliser le <strong>formulaire d'attributs</strong>.</p> <p>Ainsi, il est possible de déterminer le <strong>style du champ</strong> (date, nombre, liste de valeurs, ...), une <strong>valeur par défaut</strong> et des <strong>contraintes</strong> telles que l'obligation de remplir le champ.</p> <p><img src="/assets/img/attributes_form.1860b71c.png" alt="attribute-form"></p> <p>Nous souhaitons donc récupérer ces informations de sorte à mettre en forme le <strong>Formulaire</strong> de l'application client de la même manière.</p> <h4 id="permettre-la-saisie-d-informations"><a href="#permettre-la-saisie-d-informations" class="header-anchor">#</a> Permettre la saisie d'informations</h4> <p>L'objectif étant également de permettre à l'utilisateur de saisir des <strong>informations</strong> nécessaires au bon fonctionnement de l'application client, il faut mettre en place une <strong>interface utilisateur</strong>.</p> <h4 id="generer-le-fichier-de-configuration"><a href="#generer-le-fichier-de-configuration" class="header-anchor">#</a> Générer le fichier de configuration</h4> <p>Enfin, il est nécessaire de l'application soit en mesure de <strong>retranscrire</strong> toutes les informations au sein d'un <strong>fichier</strong>.</p> <p>L'extension doit également permettre à l'utilisateur de choisir la <strong>destination</strong> de ce fichier.</p> <h2 id="solution-proposee"><a href="#solution-proposee" class="header-anchor">#</a> Solution proposée</h2> <p>Après quelques jours de développement, je suis parvenu à un résultat répondant aux besoins.</p> <p><img src="/assets/img/config_preview.75627b86.gif" alt="preview"></p> <h3 id="fonctionnement"><a href="#fonctionnement" class="header-anchor">#</a> Fonctionnement</h3> <p>Le fonctionnement de l'extension est assez <strong>simple</strong> puisqu'il n'est composé que de <strong>trois étapes</strong>.</p> <h4 id="_1-recuperation-des-donnees"><a href="#_1-recuperation-des-donnees" class="header-anchor">#</a> 1. Récupération des données</h4> <p>Au lancement, le plugin se charge de <strong>récupérer les données des couches</strong>.</p> <p>De la même manière que pour le projet <a href="/projets-annexes/smc">SMC</a>, je me sers l'API <a href="https://qgis.org/pyqgis/3.0/" target="_blank" rel="noopener noreferrer">PyQGIS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> pour accéder à ces informations.</p> <h4 id="_2-interface-utilisateur"><a href="#_2-interface-utilisateur" class="header-anchor">#</a> 2. Interface utilisateur</h4> <p>Lorsque les données ont été récupérées, <strong>l'interface apparaît</strong> et l'utilisateur peut commencer à <strong>saisir des informations</strong>.</p> <p>L'interface est découpée en plusieurs partie, chacune étant liée à une <strong>section</strong> du <strong>fichier de configuration</strong> (cf. <a href="/cartogis54/client.html#configuration">Application Client</a>).</p> <h5 id="destination"><a href="#destination" class="header-anchor">#</a> Destination</h5> <p>Sur la partie <strong>supérieure</strong> de l'application, le champ <em>Destination</em> permet à l'utilisateur d'indiquer le <strong>chemin</strong> vers le répertoire dans lequel l'extension enregistrera le <strong>fichier de sortie</strong>.</p> <p><img src="/assets/img/config_destination.9aaf2c8e.png" alt="destination"></p> <p>En cliquant sur le boutton à droite de ce champ, l'utilisateur peut utiliser <strong>l'explorateur de fichier</strong> pour sélectionner le répertoire de manière <strong>interactive</strong>.</p> <h5 id="server"><a href="#server" class="header-anchor">#</a> Server</h5> <p>Cette section permet à l'utilisateur de saisir <strong>l'URL</strong> ou <strong>l'adresse IP</strong> du <strong>serveur de flux WMS/WFS</strong> vers lequel l'application client devra effectuer des <strong>requêtes</strong>.</p> <p><img src="/assets/img/config_server.f7a49f4d.png" alt="server"></p> <p>De plus, à l'aide du tableau <em>Query parameters</em> il est possible de définir des <strong>paramètres</strong> qui seront ajoutés à chaque requête vers le serveur.</p> <h5 id="header"><a href="#header" class="header-anchor">#</a> Header</h5> <p>Cet onglet est utile si vous souhaitez ajouter un <strong>logo</strong> dans <strong>l'En-tête</strong> de l'interface de votre application client ou bien si vous souhaitez y intégrer des <strong>modales</strong>.</p> <p><img src="/assets/img/config_header.5c789952.png" alt="header"></p> <h5 id="form"><a href="#form" class="header-anchor">#</a> Form</h5> <p>Cette dernière section permet de compléter la configuration des champs du <strong>Formulaire</strong> puisqu'elle permet de définir les champs qui doivent être <strong>désactivés</strong> ou <strong>cachés</strong>.</p> <p><img src="/assets/img/config_form.c8d4d8e2.png" alt="form"></p> <h4 id="_3-generation-du-fichier"><a href="#_3-generation-du-fichier" class="header-anchor">#</a> 3. Génération du fichier</h4> <p>Au clic sur le bouton <em>Generate</em>, le plugin se charge de structurer les données au format <strong>JSON</strong> et de les <strong>écrire</strong> dans un fichier <code>app.config.json</code> placé dans le répertoire choisi par l'utilisateur.</p> <p>Pour ce faire, on utilise le package <code>os</code> de <strong>Python</strong>, permettant de maniupler le <strong>système de fichiers</strong> de la machine :</p> <p><strong><code>utils/output.py</code></strong></p> <div class="language-py extra-class"><pre class="language-py"><code> <span class="token keyword">def</span> <span class="token function">save</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    parsed_structure <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>self<span class="token punctuation">.</span>structure<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>path<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;w+&quot;</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>parsed_structure<span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="structure"><a href="#structure" class="header-anchor">#</a> Structure</h3> <p>La <strong>structure</strong> du projet est presque la même que celle du projet <a href="/projets-annexes/smc">SMC</a> :</p> <div class="language-shell extra-class"><pre class="language-shell"><code>-- <span class="token variable">$REPERTOIRE_QGIS_PLUGINS</span>
  <span class="token operator">|</span>-- CartoGIS54-config/
    <span class="token operator">|</span>-- utils/
        <span class="token operator">|</span>-- __init__.py
        <span class="token operator">|</span>-- form.py
        <span class="token operator">|</span>-- modals.py
        <span class="token operator">|</span>-- output.py
        <span class="token operator">|</span>-- server.py
    <span class="token operator">|</span>-- __init__.py
    <span class="token operator">|</span>-- icon.png
    <span class="token operator">|</span>-- metadata.txt
    <span class="token operator">|</span>-- pb_tool.cfg
    <span class="token operator">|</span>-- cartogis54.py
    <span class="token operator">|</span>-- cartogis54_dialog.py
    <span class="token operator">|</span>-- cartogis54_dialog_base.ui
    <span class="token operator">|</span>-- README.md
    <span class="token operator">|</span>-- resources.py
    <span class="token operator">|</span>-- resources.qrc
</code></pre></div><ul><li><code>utils/form.py</code> : des fonctions permettant de remplir la table de la section Form.</li> <li><code>utils/modals.py</code> : des fonctions permettant de remplir la table de la section Header.</li> <li><code>utils/output.py</code> : une classe qui structure les données et génère le fichier de sortie.</li> <li><code>utils/server.py</code> : des fonctions permettant de remplir la table de la section Server.</li></ul> <div class="custom-block warning"><p class="custom-block-title">Note</p> <p>Le contenu des autres fichiers est presque le même que celui de fichiers du projet <a href="/projets-annexes/smc">SMC</a>.</p></div> <h3 id="developpement"><a href="#developpement" class="header-anchor">#</a> Développement</h3> <p>Étant donné que ce projet s'est voulu assez <strong>similaire</strong> au projet <a href="/projets-annexes/smc">SMC</a>, le développement s'est déroulé sans <strong>aucune difficulté</strong> puisque j'étais déjà à l'aise avec l'utilisation de l'API <a href="https://doc.qt.io/qtforpython/" target="_blank" rel="noopener noreferrer">PyQt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> et de l'API <a href="https://qgis.org/pyqgis/3.0/" target="_blank" rel="noopener noreferrer">PyQGIS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, au sein desquelles j'ai pu trouver tous les outils m'ayant permis de parvenir au résultat présenté.</p> <h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion</h2> <p>Bien que <strong>simple</strong>, ce plugin permet de <strong>s'affranchir d'une configuration à la main</strong>.</p> <p>Travailler sur ce projet aura <strong>renforcé mes compétences</strong> en <strong>Python</strong> et en manipulation d'API de <strong>grande envergure</strong>.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/cartogis54/client.html" class="prev">
        CartoGIS54 - Application client
      </a></span> <span class="next"><a href="/liens.html">
        Liens
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.585f677d.js" defer></script><script src="/assets/js/2.25621a30.js" defer></script><script src="/assets/js/3.4803905f.js" defer></script>
  </body>
</html>
